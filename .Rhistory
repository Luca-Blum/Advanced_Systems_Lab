print(hello)
print("hello")
setwd(dirname(rstudioapi::g
setwd(dirname(rstudioapi::g
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
emissionMatrix <-read.csv()
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
this.dir <- dirname(parent.frame(2)$ofile)
this.dir <- dirname(parent.frame(2)$file)
this.dir <- dirname(parent.frame(2)$file)
setwd("~/Desktop/AsysProject/team035")
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix')
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv')
print(emissionMatrix)
head(emissionMatrix)
View(emissionMatrix)
View(emissionMatrix)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
head(emissionMatrix)
View(emissionMatrix)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
head(emissionMatrix)
View(stateProb)
View(stateProb)
# Initial HMM
hmm = initHMM(c("A","B"),c("L","R"),
transProbs=matrix(c(.9,.1,.1,.9),2),
emissionProbs=matrix(c(.5,.51,.5,.49),2))
print(hmm)
# Sequence of observation
a = sample(c(rep("L",100),rep("R",300)))
b = sample(c(rep("L",300),rep("R",100)))
observation = c(a,b)
# Baum-Welch
bw = baumWelch(hmm,observation,10)
print(bw$hmm)
install.packages("HMM")
# Initial HMM
hmm = initHMM(c("A","B"),c("L","R"),
transProbs=matrix(c(.9,.1,.1,.9),2),
emissionProbs=matrix(c(.5,.51,.5,.49),2))
print(hmm)
# Sequence of observation
a = sample(c(rep("L",100),rep("R",300)))
b = sample(c(rep("L",300),rep("R",100)))
observation = c(a,b)
# Baum-Welch
bw = baumWelch(hmm,observation,10)
print(bw$hmm)
load(HMM)
library("HMM", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
# Initial HMM
hmm = initHMM(c("A","B"),c("L","R"),
transProbs=matrix(c(.9,.1,.1,.9),2),
emissionProbs=matrix(c(.5,.51,.5,.49),2))
print(hmm)
# Sequence of observation
a = sample(c(rep("L",100),rep("R",300)))
b = sample(c(rep("L",300),rep("R",100)))
observation = c(a,b)
# Baum-Welch
bw = baumWelch(hmm,observation,10)
print(bw$hmm)
length(stateProbs)
length(stateProb)
size(stateProb)
length(stateProb)
lengths(stateProb)
stateProb <-transpose(stateProb)
stateProb <-t(stateProb)
stateProb
length(stateProb)
length(emissionMatrix)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
hmm = initHMM(seq(1,length(t(stateProb)), by=1),seq(1,length(emissionMatrix), by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
hmm = initHMM(seq(1,length(t(stateProb)), by=1),seq(1,length(emissionMatrix), by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
hmm = initHMM(seq(1,length(t(stateProb)), by=1),seq(1,length(emissionMatrix), by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
hmm = initHMM(seq(1,length(t(stateProb)), by=1),seq(1,length(emissionMatrix), by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
hmm = initHMM(seq(1,length(t(stateProb)), by=1),seq(1,length(emissionMatrix), by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
hmm = initHMM(seq(1,length(t(stateProb)), by=1),seq(1,length(emissionMatrix), by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
stateProb <-t(stateProb)
hmm = initHMM(seq(1,length(stateProb), by=1),seq(1,length(emissionMatrix), by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
transitionMatrix<-t(transitionMatrix)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
stateProb <-t(stateProb)
hmm = initHMM(seq(1,length(stateProb), by=1),seq(1,length(emissionMatrix), by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
# Initial HMM
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
emissionMatrix<-t(emissionMatrix)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
transitionMatrix<-t(transitionMatrix)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
stateProb <-t(stateProb)
hmm = initHMM(seq(1,length(stateProb), by=1),seq(1,length(emissionMatrix), by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
length(emissionMatrix)
width(emissionMatrix)
dim(emissionMatrix)
dim(emissionMatrix)[0]
dim(emissionMatrix)[1]
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
emissionMatrix<-t(emissionMatrix)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
transitionMatrix<-t(transitionMatrix)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
stateProb <-t(stateProb)
hmm = initHMM(seq(1,length(stateProb), by=1),seq(1,dim(emissionMatrix)[1], by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
# Baum-Welch
bw = baumWelch(hmm,observation,10)
print(hmm)
View(observations)
View(observations)
observation[1]
observations[1]
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
observations<-t(observations)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
observations<-t(observations)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
observations<-t(observations)
observations[1]
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
emissionMatrix<-t(emissionMatrix)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
transitionMatrix<-t(transitionMatrix)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
observations<-t(observations)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
stateProb <-t(stateProb)
hmm = initHMM(seq(1,length(stateProb), by=1),seq(1,dim(emissionMatrix)[1], by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
# Baum-Welch
bw = baumWelc
# Baum-Welch
bw = baumWelch(hmm,observation,10)
# Baum-Welch
bw = baumWelch(hmm,observations,10)
print(bw$hmm)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
emissionMatrix<-t(emissionMatrix)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
transitionMatrix<-t(transitionMatrix)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
observations<-t(observations)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
stateProb <-t(stateProb)
hmm = initHMM(seq(1,length(stateProb), by=1),seq(1,dim(emissionMatrix)[1], by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
# Baum-Welch
bw = baumWelch(hmm,observations,10)
print(bw$hmm)
View(observations)
View(observations)
# Baum-Welch
bw = baumWelch(hmm,observations,100)
# Baum-Welch
bw = baumWelch(hmm,observations,100)
# Baum-Welch
bw = baumWelch(hmm,observations,100)
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
emissionMatrix<-t(emissionMatrix)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
transitionMatrix<-t(transitionMatrix)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
observations<-t(observations)
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
stateProb <-t(stateProb)
hmm = initHMM(seq(1,length(stateProb), by=1),seq(1,dim(emissionMatrix)[1], by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
# Baum-Welch
# Baum-Welch
bw = baumWelch(hmm,observations,100)
# Baum-Welch
bw = baumWelch(hmm,observations,50)
# Baum-Welch
bw = baumWelch(hmm,observations,maxIterations = 100)
# Baum-Welch
bw = baumWelch(hmm,observations,maxIterations = 10)
print(bw$hmm)
# Baum-Welch
bw = baumWelch(hmm,observations,maxIterations = 10)
hmm = initHMM(seq(1,length(stateProb), by=1),seq(1,dim(emissionMatrix)[1], by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
# Baum-Welch
bw = baumWelch(hmm,observations,maxIterations = 10)
print(bw$hmm)
# Baum-Welch
bw = baumWelch(hmm,observations,maxIterations = 10)
View(observations)
View(observations)
sum(observations,1)
observations +1
groundEmissionMatrix<- read.csv(file = 'test_matrices/groundEmissionMatrix.csv',header=FALSE)
groundTransitionMatrix<- read.csv(file = 'test_matrices/groundTransitionMatrix.csv',header=FALSE)
emissionMatrix<- read.csv(file = 'test_matrices/emissionMatrix.csv',header=FALSE)
emissionMatrix<-t(emissionMatrix)
transitionMatrix<- read.csv(file = 'test_matrices/transitionMatrix.csv',header=FALSE)
transitionMatrix<-t(transitionMatrix)
observations<- read.csv(file = 'test_matrices/observations.csv',header=FALSE)
observations<-t(observations)+1
stateProb<- read.csv(file = 'test_matrices/stateProb.csv',header=FALSE)
stateProb <-t(stateProb)
hmm = initHMM(seq(1,length(stateProb), by=1),seq(1,dim(emissionMatrix)[1], by=1),startProbs=stateProb, transProbs=transitionMatrix, emissionProbs=emissionMatrix)
print(hmm)
# Baum-Welch
bw = baumWelch(hmm,observations,maxIterations = 10)
# Baum-Welch
bw = baumWelch(hmm,observations,maxIterations = 10)
print(bw$hmm)
# Baum-Welch
bw = baumWelch(hmm,observations,maxIterations = 100)
print(bw$hmm)
# Baum-Welch
bw = baumWelch(hmm,observations,maxIterations = 1000)
print(bw$hmm)
#source:
# https://github.com/adeveloperdiary/HiddenMarkovModel
forward = function(v, a, b, initial_distribution){
T = length(v)
M = nrow(a)
alpha = matrix(0, T, M)
alpha[1, ] = initial_distribution*b[, v[1]]
for(t in 2:T){
tmp = alpha[t-1, ] %*% a
alpha[t, ] = tmp * b[, v[t]]
}
return(alpha)
}
backward = function(v, a, b){
T = length(v)
M = nrow(a)
beta = matrix(1, T, M)
for(t in (T-1):1){
tmp = as.matrix(beta[t+1, ] * b[, v[t+1]])
beta[t, ] = t(a %*% tmp)
}
return(beta)
}
BaumWelch = function(v, a, b, initial_distribution, n.iter = 100){
for(i in 1:n.iter){
T = length(v)
M = nrow(a)
K=ncol(b)
alpha = forward(v, a, b, initial_distribution)
beta = backward(v, a, b)
xi = array(0, dim=c(M, M, T-1))
for(t in 1:T-1){
denominator = ((alpha[t,] %*% a) * b[,v[t+1]]) %*% matrix(beta[t+1,])
for(s in 1:M){
numerator = alpha[t,s] * a[s,] * b[,v[t+1]] * beta[t+1,]
xi[s,,t]=numerator/as.vector(denominator)
}
}
xi.all.t = rowSums(xi, dims = 2)
a = xi.all.t/rowSums(xi.all.t)
gamma = apply(xi, c(1, 3), sum)
gamma = cbind(gamma, colSums(xi[, , T-1]))
for(l in 1:K){
b[, l] = rowSums(gamma[, which(v==l)])
}
b = b/rowSums(b)
}
return(list(a = a, b = b, initial_distribution = initial_distribution))
}
data = read.csv("data_r.csv")
M=2; K=3
A = matrix(1, M, M)
A = A/rowSums(A)
B = matrix(1:6, M, K)
B = B/rowSums(B)
initial_distribution = c(1/2, 1/2)
(myout = BaumWelch(data$Visible, A, B, initial_distribution, n.iter = 100))
#source:
# https://github.com/adeveloperdiary/HiddenMarkovModel
forward = function(v, a, b, initial_distribution){
T = length(v)
M = nrow(a)
alpha = matrix(0, T, M)
alpha[1, ] = initial_distribution*b[, v[1]]
for(t in 2:T){
tmp = alpha[t-1, ] %*% a
alpha[t, ] = tmp * b[, v[t]]
}
return(alpha)
}
backward = function(v, a, b){
T = length(v)
M = nrow(a)
beta = matrix(1, T, M)
for(t in (T-1):1){
tmp = as.matrix(beta[t+1, ] * b[, v[t+1]])
beta[t, ] = t(a %*% tmp)
}
return(beta)
}
BaumWelch = function(v, a, b, initial_distribution, n.iter = 100){
for(i in 1:n.iter){
T = length(v)
M = nrow(a)
K=ncol(b)
alpha = forward(v, a, b, initial_distribution)
beta = backward(v, a, b)
xi = array(0, dim=c(M, M, T-1))
for(t in 1:T-1){
denominator = ((alpha[t,] %*% a) * b[,v[t+1]]) %*% matrix(beta[t+1,])
for(s in 1:M){
numerator = alpha[t,s] * a[s,] * b[,v[t+1]] * beta[t+1,]
xi[s,,t]=numerator/as.vector(denominator)
}
}
xi.all.t = rowSums(xi, dims = 2)
a = xi.all.t/rowSums(xi.all.t)
gamma = apply(xi, c(1, 3), sum)
gamma = cbind(gamma, colSums(xi[, , T-1]))
for(l in 1:K){
b[, l] = rowSums(gamma[, which(v==l)])
}
b = b/rowSums(b)
}
return(list(a = a, b = b, initial_distribution = initial_distribution))
}
data = read.csv("data_r.csv")
M=2; K=3
A = matrix(1, M, M)
A = A/rowSums(A)
B = matrix(1:6, M, K)
B = B/rowSums(B)
initial_distribution = c(1/2, 1/2)
(myout = BaumWelch(data$Visible, A, B, initial_distribution, n.iter = 100))
data = read.csv("data_r.csv")
M=2; K=3
data = read.csv("data_r.csv")
pwd
